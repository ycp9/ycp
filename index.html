<script>
    emailjs.init({
        publicKey: "Pbctw-6eSrIW2ugyg",
    });

    function openContactModal() {
        document.getElementById("contactModal").classList.add("active");
        document.body.style.overflow = "hidden";
    }

    function closeContactModal() {
        document.getElementById("contactModal").classList.remove("active");
        document.body.style.overflow = "auto";
        document.getElementById("contactForm").reset();
        document.getElementById("statusMessage").textContent = "";
        document.getElementById("statusMessage").className = "status-message";
        document.getElementById("submitBtn").disabled = false;
        document.getElementById("submitBtn").textContent = "Send Message";
    }

    document.getElementById("contactForm").addEventListener("submit", async (e) => {
        e.preventDefault();

        const submitBtn = document.getElementById("submitBtn");
        const statusMessage = document.getElementById("statusMessage");

        submitBtn.disabled = true;
        submitBtn.textContent = "Sending...";
        statusMessage.className = "status-message";
        statusMessage.textContent = "";

        try {
            await emailjs.sendForm(
                "service_janw4k8",
                "template_di7cjv4",
                "#contactForm"
            );

            statusMessage.textContent = "Message sent! We'll get back to you soon.";
            statusMessage.classList.add("success");

            setTimeout(() => {
                closeContactModal();
            }, 2000);

        } catch (error) {
            console.error(error);
            statusMessage.textContent = "Error sending message. Try again.";
            statusMessage.classList.add("error");
            submitBtn.disabled = false;
            submitBtn.textContent = "Send Message";
        }
    });

    document.getElementById("contactModal").addEventListener("click", function(e) {
        if (e.target === this) {
            closeContactModal();
        }
    });

    // Optional: prevent-inspect stuff
    document.addEventListener("contextmenu", (e) => e.preventDefault());
    document.addEventListener("keydown", (e) => {
        if (
            e.key === "F12" ||
            (e.ctrlKey && e.shiftKey && ["I", "J", "C"].includes(e.key))
        ) {
            e.preventDefault();
        }
    });

    // Snow effect
    const canvas = document.getElementById("snowCanvas");
    const ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const snowflakes = [];

    class Snowflake {
        constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height - canvas.height;
            this.radius = Math.random() * 2 + 0.5;
            this.velocity = Math.random() * 0.8 + 0.3;
            this.opacity = Math.random() * 0.6 + 0.2;
            this.drift = Math.random() * 0.3 - 0.15;
        }

        update() {
            this.y += this.velocity;
            this.x += this.drift;

            if (this.y > canvas.height) {
                this.y = -10;
                this.x = Math.random() * canvas.width;
            }
        }

        draw() {
            ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fill();
        }
    }

    for (let i = 0; i < 100; i++) snowflakes.push(new Snowflake());

    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        snowflakes.forEach((s) => {
            s.update();
            s.draw();
        });
        requestAnimationFrame(animate);
    }

    animate();

    window.addEventListener("resize", () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
</script>
